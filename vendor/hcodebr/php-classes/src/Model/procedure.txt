CREATE DEFINER='root'@'localhost' PROCEDURE 'sp_users_save'(
	pdesperson VARCHAR(64),
	pdeslogin VARCHAR(64),
	pdespassword VARCHAR(256),
	pdesemail VARCHAR(128),
	pnrphone BIGINT,
	pinadmin TINYINT
)
BEGIN

	DECLARE vidperson INT;

	INSERT INTO tb_persons (desperson, desemail, nrphone)
	VALUES(pdesperson, pdesemail, pnrphone);

	SET vidperson = LAST_INSERT_ID();

	INSERT INTO tb_users (idperson, deslogin, despassword, inadmin)
	VALUES(vidperson, pdeslogin, pdespassword, pinadmin);

	SELECT * FROM tb_users a INNER JOIN tb_persons b USING(idperson) WHERE a.iduser = LAST_INSERT_ID();

END